

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>core package &mdash; logRASM v1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5cb08e4e"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="main_genOtherSeeds module" href="main_genOtherSeeds.html" />
    <link rel="prev" title="collect_checkpoints module" href="collect_checkpoints.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            logRASM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ReadMe.html">Policy Verification in Stochastic Dynamical Systems Using Logarithmic Neural Certificates</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReadMe.html#what-does-this-code-do">1. What does this code do?</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReadMe.html#run-from-a-docker-container-preferred">2. Run from a Docker container (preferred)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReadMe.html#installing-from-source">3. Installing from source</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReadMe.html#running-for-a-single-benchmark-smoke-test">4. Running for a single benchmark (smoke test)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReadMe.html#reproducing-results-from-the-paper">5. Reproducing results from the paper</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReadMe.html#training-policies-with-stable-baselines">6. Training policies with Stable-Baselines</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReadMe.html#overview-of-input-arguments">7. Overview of input arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReadMe.html#rebuilding-the-docker-container">8. Rebuilding the Docker container</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Code documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="LipBaB.html">LipBaB module</a></li>
<li class="toctree-l2"><a class="reference internal" href="LipBaB_finalcheckpoint.html">LipBaB_finalcheckpoint module</a></li>
<li class="toctree-l2"><a class="reference internal" href="LipBaB_interpret_results.html">LipBaB_interpret_results module</a></li>
<li class="toctree-l2"><a class="reference internal" href="collect_checkpoints.html">collect_checkpoints module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">core package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.buffer">core.buffer module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.buffer.Buffer"><code class="docutils literal notranslate"><span class="pre">Buffer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.buffer.cell_width2mesh"><code class="docutils literal notranslate"><span class="pre">cell_width2mesh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.buffer.define_grid"><code class="docutils literal notranslate"><span class="pre">define_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.buffer.define_grid_jax"><code class="docutils literal notranslate"><span class="pre">define_grid_jax()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.buffer.mesh2cell_width"><code class="docutils literal notranslate"><span class="pre">mesh2cell_width()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.buffer.meshgrid_jax"><code class="docutils literal notranslate"><span class="pre">meshgrid_jax()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.commons">core.commons module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.commons.MultiRectangularSet"><code class="docutils literal notranslate"><span class="pre">MultiRectangularSet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.commons.Namespace"><code class="docutils literal notranslate"><span class="pre">Namespace</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.commons.RectangularSet"><code class="docutils literal notranslate"><span class="pre">RectangularSet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.commons.TicTocDifference"><code class="docutils literal notranslate"><span class="pre">TicTocDifference()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.commons.TicTocGenerator"><code class="docutils literal notranslate"><span class="pre">TicTocGenerator()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.commons.args2dict"><code class="docutils literal notranslate"><span class="pre">args2dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.commons.tic"><code class="docutils literal notranslate"><span class="pre">tic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.commons.ticDiff"><code class="docutils literal notranslate"><span class="pre">ticDiff()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.commons.toc"><code class="docutils literal notranslate"><span class="pre">toc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.commons.tocDiff"><code class="docutils literal notranslate"><span class="pre">tocDiff()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.jax_utils">core.jax_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.jax_utils.AgentState"><code class="docutils literal notranslate"><span class="pre">AgentState</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.jax_utils.MLP"><code class="docutils literal notranslate"><span class="pre">MLP</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.jax_utils.apply_ibp_rectangular"><code class="docutils literal notranslate"><span class="pre">apply_ibp_rectangular()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.jax_utils.create_batches"><code class="docutils literal notranslate"><span class="pre">create_batches()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.jax_utils.create_nn_states"><code class="docutils literal notranslate"><span class="pre">create_nn_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.jax_utils.create_train_state"><code class="docutils literal notranslate"><span class="pre">create_train_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.jax_utils.lipschitz_coeff"><code class="docutils literal notranslate"><span class="pre">lipschitz_coeff()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.jax_utils.load_policy_config"><code class="docutils literal notranslate"><span class="pre">load_policy_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.jax_utils.orbax_parse_activation_fn"><code class="docutils literal notranslate"><span class="pre">orbax_parse_activation_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.jax_utils.orbax_set_config"><code class="docutils literal notranslate"><span class="pre">orbax_set_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.learner">core.learner module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.learner.Learner"><code class="docutils literal notranslate"><span class="pre">Learner</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.logger">core.logger module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.logger.Logger"><code class="docutils literal notranslate"><span class="pre">Logger</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.parse_args">core.parse_args module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.parse_args.parse_arguments"><code class="docutils literal notranslate"><span class="pre">parse_arguments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.parse_args.set_mesh_loss"><code class="docutils literal notranslate"><span class="pre">set_mesh_loss()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.plot">core.plot module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.plot.plot_boxes"><code class="docutils literal notranslate"><span class="pre">plot_boxes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.plot.plot_certificate_2D"><code class="docutils literal notranslate"><span class="pre">plot_certificate_2D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.plot.plot_dataset"><code class="docutils literal notranslate"><span class="pre">plot_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.plot.plot_heatmap"><code class="docutils literal notranslate"><span class="pre">plot_heatmap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.plot.plot_layout"><code class="docutils literal notranslate"><span class="pre">plot_layout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.plot.plot_traces"><code class="docutils literal notranslate"><span class="pre">plot_traces()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.plot.position_fraction"><code class="docutils literal notranslate"><span class="pre">position_fraction()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.plot.position_in_heatmap"><code class="docutils literal notranslate"><span class="pre">position_in_heatmap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.plot.vector_plot"><code class="docutils literal notranslate"><span class="pre">vector_plot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.ppo_jax">core.ppo_jax module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.Actor"><code class="docutils literal notranslate"><span class="pre">Actor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.AgentParams"><code class="docutils literal notranslate"><span class="pre">AgentParams</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.AgentState"><code class="docutils literal notranslate"><span class="pre">AgentState</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.Critic"><code class="docutils literal notranslate"><span class="pre">Critic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.EpisodeStatistics"><code class="docutils literal notranslate"><span class="pre">EpisodeStatistics</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.PPO"><code class="docutils literal notranslate"><span class="pre">PPO()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.PPOargs"><code class="docutils literal notranslate"><span class="pre">PPOargs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.Storage"><code class="docutils literal notranslate"><span class="pre">Storage</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.compute_gae"><code class="docutils literal notranslate"><span class="pre">compute_gae()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.compute_gae_body"><code class="docutils literal notranslate"><span class="pre">compute_gae_body()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.compute_gae_jit"><code class="docutils literal notranslate"><span class="pre">compute_gae_jit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.get_action_and_value"><code class="docutils literal notranslate"><span class="pre">get_action_and_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.get_action_and_value2"><code class="docutils literal notranslate"><span class="pre">get_action_and_value2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.linear_layer_init"><code class="docutils literal notranslate"><span class="pre">linear_layer_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.rollout_jax"><code class="docutils literal notranslate"><span class="pre">rollout_jax()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.rollout_jax_jit"><code class="docutils literal notranslate"><span class="pre">rollout_jax_jit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.update_ppo"><code class="docutils literal notranslate"><span class="pre">update_ppo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.ppo_jax.update_ppo_jit"><code class="docutils literal notranslate"><span class="pre">update_ppo_jit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.verifier">core.verifier module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.verifier.Verifier"><code class="docutils literal notranslate"><span class="pre">Verifier</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.verifier.batched_forward_pass"><code class="docutils literal notranslate"><span class="pre">batched_forward_pass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.verifier.batched_forward_pass_ibp"><code class="docutils literal notranslate"><span class="pre">batched_forward_pass_ibp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#core.verifier.grid_multiply_shift"><code class="docutils literal notranslate"><span class="pre">grid_multiply_shift()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="main_genOtherSeeds.html">main_genOtherSeeds module</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html">models package</a></li>
<li class="toctree-l2"><a class="reference internal" href="run.html">run module</a></li>
<li class="toctree-l2"><a class="reference internal" href="table_generator.html">table_generator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="train_SB3.html">train_SB3 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="validate_certificate.html">validate_certificate module</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">logRASM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">Code documentation</a></li>
      <li class="breadcrumb-item active">core package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/core.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="core-package">
<h1>core package<a class="headerlink" href="#core-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-core.buffer">
<span id="core-buffer-module"></span><h2>core.buffer module<a class="headerlink" href="#module-core.buffer" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.buffer.Buffer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.buffer.</span></span><span class="sig-name descname"><span class="pre">Buffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/buffer.html#Buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.buffer.Buffer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to store samples (from the state space) in a buffer.</p>
<dl class="py method">
<dt class="sig sig-object py" id="core.buffer.Buffer.append">
<span class="sig-name descname"><span class="pre">append</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/buffer.html#Buffer.append"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.buffer.Buffer.append" title="Link to this definition"></a></dt>
<dd><p>Append given samples to training buffer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> – numpy array containing the samples to append.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.buffer.Buffer.append_and_remove">
<span class="sig-name descname"><span class="pre">append_and_remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">refresh_fraction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perturb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/buffer.html#Buffer.append_and_remove"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.buffer.Buffer.append_and_remove" title="Link to this definition"></a></dt>
<dd><p>Removes a given fraction of the training buffer and appends the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>refresh_fraction</strong> – float, fraction of the buffer to refresh.</p></li>
<li><p><strong>samples</strong> – numpy array containing the samples to append.</p></li>
<li><p><strong>perturb</strong> – boolean. If true, perturb each samples (within their cells; uniform distribution).</p></li>
<li><p><strong>cell_width</strong> – boolean or float. If a float, it is the size of each cell (only required if perturb is True).</p></li>
<li><p><strong>verbose</strong> – boolean. If true, print more information.</p></li>
<li><p><strong>weighted_sampling</strong> – boolean. If true, refresh buffer according to the given weights.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.buffer.cell_width2mesh">
<span class="sig-prename descclassname"><span class="pre">core.buffer.</span></span><span class="sig-name descname"><span class="pre">cell_width2mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Linfty</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/buffer.html#cell_width2mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.buffer.cell_width2mesh" title="Link to this definition"></a></dt>
<dd><p>Convert cell width in L1 norm to mesh size in a rectangular gridding
Given the L1 or Linfty norm ||.||, computes the largest mesh such that a 
axis-aligned rectangle with given cell_width and center c (not specified)
contains the set {x : ||x-c|| &lt;= mesh}.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_width</strong> – float, cell width of the cell.</p></li>
<li><p><strong>dim</strong> – int, dimension of the state space.</p></li>
<li><p><strong>Linfty</strong> – boolean, whether the Linfty norm (rather than the L1 norm) should be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>float, the norm bound from the center of the cell.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.buffer.define_grid">
<span class="sig-prename descclassname"><span class="pre">core.buffer.</span></span><span class="sig-name descname"><span class="pre">define_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/buffer.html#define_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.buffer.define_grid" title="Link to this definition"></a></dt>
<dd><p>Set rectangular grid over state space for neural network learning
Specifically, given lower and upper bounds low[i] and high[i] for each dimension, 
and the number of points size[i] for each dimension, creates the grid consisting
of all prod_i size[i] points whose ith coordinate can be written as</p>
<blockquote>
<div><p>low[i] + j (high[i] - low[i])/(size[i]-1)</p>
</div></blockquote>
<p>for some 0 &lt;= j &lt;= size[i]-1 that can depend on i.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>low</strong> – List of floats (lower bound grid per dimension).</p></li>
<li><p><strong>high</strong> – List of floats (upper bound grid per dimension).</p></li>
<li><p><strong>size</strong> – List of ints (entries per dimension).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Numpy array of size (prod_i size[i], len(size)), containing the points in the grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.buffer.define_grid_jax">
<span class="sig-prename descclassname"><span class="pre">core.buffer.</span></span><span class="sig-name descname"><span class="pre">define_grid_jax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linspace'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/buffer.html#define_grid_jax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.buffer.define_grid_jax" title="Link to this definition"></a></dt>
<dd><p>Set rectangular grid over state space for neural network learning (using jax)
Specifically, given lower and upper bounds low[i] and high[i] for each dimension, 
and the number of points size[i] for each dimension, creates the grid consisting
of all prod_i size[i] points whose ith coordinate can be written as</p>
<blockquote>
<div><p>low[i] + j (high[i] - low[i])/(size[i]-1)</p>
</div></blockquote>
<p>for some 0 &lt;= j &lt;= size[i]-1 that can depend on i.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>low</strong> – List of floats (lower bound grid per dimension).</p></li>
<li><p><strong>high</strong> – List of floats (upper bound grid per dimension).</p></li>
<li><p><strong>size</strong> – List of ints (entries per dimension).</p></li>
<li><p><strong>mode</strong> – Determines whether the numpy function linspace or arange is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Jax numpy array of size (prod_i size[i], len(size)), containing the points in the grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.buffer.mesh2cell_width">
<span class="sig-prename descclassname"><span class="pre">core.buffer.</span></span><span class="sig-name descname"><span class="pre">mesh2cell_width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Linfty</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/buffer.html#mesh2cell_width"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.buffer.mesh2cell_width" title="Link to this definition"></a></dt>
<dd><p>Convert mesh size in L1 (or Linfty) norm to cell width in a rectangular gridding
Given the L1 or Linfty norm ||.||, computes the cell width of the largest 
axis-aligned rectangle inside a cell of the form {x : ||x-c|| &lt;= mesh}, where c is
some fixed arbitary center (not required to be specified).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – float, the norm bound from the center of the cell.</p></li>
<li><p><strong>dim</strong> – int, the dimension of the state space.</p></li>
<li><p><strong>Linfty</strong> – boolean, whether the Linfty norm (rather than the L1 norm) should be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>float, the cell width of the cell.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.buffer.meshgrid_jax">
<span class="sig-prename descclassname"><span class="pre">core.buffer.</span></span><span class="sig-name descname"><span class="pre">meshgrid_jax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/buffer.html#meshgrid_jax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.buffer.meshgrid_jax" title="Link to this definition"></a></dt>
<dd><p>Set rectangular grid over state space for neural network learning (using jax)
Specifically, given a list of points points[i] for each dimension, 
creates the grid consisting of all prod_i len(points[i]) points 
whose ith coordinate is an element of points[i] for all i.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> – List of len(size) lists of floats (coordinates per dimension).</p></li>
<li><p><strong>size</strong> – List of ints (entries per dimension).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Jax numpy array of size (prod_i size[i], len(size)), containing the points in the grid.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-core.commons">
<span id="core-commons-module"></span><h2>core.commons module<a class="headerlink" href="#module-core.commons" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.commons.MultiRectangularSet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.commons.</span></span><span class="sig-name descname"><span class="pre">MultiRectangularSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#MultiRectangularSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.MultiRectangularSet" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to create a list of rectangular sets.</p>
<dl class="py method">
<dt class="sig sig-object py" id="core.commons.MultiRectangularSet.contains">
<span class="sig-name descname"><span class="pre">contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#MultiRectangularSet.contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.MultiRectangularSet.contains" title="Link to this definition"></a></dt>
<dd><p>Determine all points which are contained in the any of the rectangular sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xvector</strong> – Numpy array of points.</p></li>
<li><p><strong>dim</strong> – integer. If not -1, only consider the first dim columns of xvector (should be dimension of state space).</p></li>
<li><p><strong>delta</strong> – float. Expand each rectangular set in each dimension by delta.</p></li>
<li><p><strong>return_indices</strong> – boolean. If true, return the indices of the points in the vector (rather than the points themselves).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(A boolean array indexing) the points contained in any of the rectangular sets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.commons.MultiRectangularSet.get_volume">
<span class="sig-name descname"><span class="pre">get_volume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#MultiRectangularSet.get_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.MultiRectangularSet.get_volume" title="Link to this definition"></a></dt>
<dd><p>Computes the volume of the union of (disjoint) rectangular sets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.commons.MultiRectangularSet.jax_contains">
<span class="sig-name descname"><span class="pre">jax_contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#MultiRectangularSet.jax_contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.MultiRectangularSet.jax_contains" title="Link to this definition"></a></dt>
<dd><p>Determine all points which are contained in the any of the rectangular sets (jax version).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xvector</strong> – Numpy array of points.</p></li>
<li><p><strong>delta</strong> – float. Expand each rectangular set in each dimension by delta.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A boolean array indexing the points contained in any of the rectangular sets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.commons.MultiRectangularSet.jax_not_contains">
<span class="sig-name descname"><span class="pre">jax_not_contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#MultiRectangularSet.jax_not_contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.MultiRectangularSet.jax_not_contains" title="Link to this definition"></a></dt>
<dd><blockquote>
<div><p>Determine all points which are <em>not</em> contained in the any of the rectangular sets (jax version).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xvector</strong> – Numpy array of points.</p></li>
<li><p><strong>delta</strong> – float. Expand each rectangular set in each dimension by delta.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A boolean array indexing the points <em>not</em> contained in any of the rectangular sets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.commons.MultiRectangularSet.not_contains">
<span class="sig-name descname"><span class="pre">not_contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#MultiRectangularSet.not_contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.MultiRectangularSet.not_contains" title="Link to this definition"></a></dt>
<dd><blockquote>
<div><p>Determine all points which are <em>not</em> contained in the any of the rectangular sets.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xvector</strong> – Numpy array of points.</p></li>
<li><p><strong>dim</strong> – integer. If not -1, only consider the first dim columns of xvector (should be dimension of state space).</p></li>
<li><p><strong>delta</strong> – float. Expand each rectangular set in each dimension by delta.</p></li>
<li><p><strong>return_indices</strong> – boolean. If true, return the indices of the points in the vector (rather than the points themselves).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(A boolean array indexing) the points <em>not</em> contained in any of the rectangular sets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.commons.MultiRectangularSet.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#MultiRectangularSet.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.MultiRectangularSet.sample" title="Link to this definition"></a></dt>
<dd><p>Sample points from each rectangular set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> – random number generator object.</p></li>
<li><p><strong>N</strong> – list, giving for each rectangular set the number of samples from that set.</p></li>
<li><p><strong>delta</strong> – float. Expand each rectangular set in each dimension by delta.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Jax Numpy array of samples from the rectangular sets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.commons.MultiRectangularSet.sample_single">
<span class="sig-name descname"><span class="pre">sample_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#MultiRectangularSet.sample_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.MultiRectangularSet.sample_single" title="Link to this definition"></a></dt>
<dd><p>Sample a single point from a single randomly chosen set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rng</strong> – random number generator object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>jax array containing a single (random) point.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="core.commons.Namespace">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.commons.</span></span><span class="sig-name descname"><span class="pre">Namespace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#Namespace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.Namespace" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="core.commons.RectangularSet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.commons.</span></span><span class="sig-name descname"><span class="pre">RectangularSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_dimensions=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#RectangularSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.RectangularSet" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to create a rectangular set with cheap containment checks (faster than gymnasium Box.contains).</p>
<dl class="py method">
<dt class="sig sig-object py" id="core.commons.RectangularSet.contains">
<span class="sig-name descname"><span class="pre">contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#RectangularSet.contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.RectangularSet.contains" title="Link to this definition"></a></dt>
<dd><p>Determine all points that are contained in the rectangular set, expanded by delta.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xvector</strong> – Numpy array of points.</p></li>
<li><p><strong>dim</strong> – integer. If not -1, only consider the first dim columns of xvector (should be dimension of state space).</p></li>
<li><p><strong>delta</strong> – float. Expand the rectangular set in each non-fixed dimension by delta.</p></li>
<li><p><strong>return_indices</strong> – boolean. If true, return the indices of the points in the vector (rather than the points themselves).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(A boolean array indexing) the points contained in the rectangular set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.commons.RectangularSet.get_volume">
<span class="sig-name descname"><span class="pre">get_volume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#RectangularSet.get_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.RectangularSet.get_volume" title="Link to this definition"></a></dt>
<dd><p>Returns the volume of the rectangular set.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, the volume of the set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.commons.RectangularSet.jax_contains">
<span class="sig-name descname"><span class="pre">jax_contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#RectangularSet.jax_contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.RectangularSet.jax_contains" title="Link to this definition"></a></dt>
<dd><p>Determine all points that are contained in the rectangular set, expanded by delta (jax version).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xvector</strong> – Numpy array of points.</p></li>
<li><p><strong>delta</strong> – float. Expand the rectangular set in each non-fixed dimension by delta.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A boolean array indexing the points contained in the rectangular set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.commons.RectangularSet.jax_not_contains">
<span class="sig-name descname"><span class="pre">jax_not_contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#RectangularSet.jax_not_contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.RectangularSet.jax_not_contains" title="Link to this definition"></a></dt>
<dd><p>Determine all points that are <em>not</em> contained in the rectangular set (jax version).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xvector</strong> – Numpy array of points.</p></li>
<li><p><strong>delta</strong> – float. Expand the rectangular set in each non-fixed dimension by delta.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A boolean array indexing the points <em>not</em> contained in the rectangular set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.commons.RectangularSet.not_contains">
<span class="sig-name descname"><span class="pre">not_contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#RectangularSet.not_contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.RectangularSet.not_contains" title="Link to this definition"></a></dt>
<dd><p>Determine all points that are <em>not</em> contained in the rectangular set, expanded by a value of delta (jax version).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xvector</strong> – Numpy array of points.</p></li>
<li><p><strong>dim</strong> – integer. If not -1, only consider the first dim columns of xvector (should be dimension of state space).</p></li>
<li><p><strong>delta</strong> – float. Expand the rectangular set in each non-fixed dimension by delta.</p></li>
<li><p><strong>return_indices</strong> – boolean. If true, return the indices of the points in the vector (rather than the points themselves).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(A boolean array indexing) the points <em>not</em> contained in the rectangular set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.commons.RectangularSet.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#RectangularSet.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.RectangularSet.sample" title="Link to this definition"></a></dt>
<dd><p>Uniformly sample N values from this rectangular state set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> – random number generator object.</p></li>
<li><p><strong>N</strong> – integer, the number of samples.</p></li>
<li><p><strong>delta</strong> – float. Expand the rectangular set in each dimension by delta.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Jax array containing the samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.commons.RectangularSet.sample_single">
<span class="sig-name descname"><span class="pre">sample_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#RectangularSet.sample_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.RectangularSet.sample_single" title="Link to this definition"></a></dt>
<dd><p>Uniformly sample one value from this rectangular state set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rng</strong> – random number generator object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Jax array containing the sample.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.commons.TicTocDifference">
<span class="sig-prename descclassname"><span class="pre">core.commons.</span></span><span class="sig-name descname"><span class="pre">TicTocDifference</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#TicTocDifference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.TicTocDifference" title="Link to this definition"></a></dt>
<dd><p>Generator that returns time differences</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.commons.TicTocGenerator">
<span class="sig-prename descclassname"><span class="pre">core.commons.</span></span><span class="sig-name descname"><span class="pre">TicTocGenerator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#TicTocGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.TicTocGenerator" title="Link to this definition"></a></dt>
<dd><p>Generator that returns the elapsed run time</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.commons.args2dict">
<span class="sig-prename descclassname"><span class="pre">core.commons.</span></span><span class="sig-name descname"><span class="pre">args2dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#args2dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.args2dict" title="Link to this definition"></a></dt>
<dd><p>Return all arguments passed to the function as a dictionary.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.commons.tic">
<span class="sig-prename descclassname"><span class="pre">core.commons.</span></span><span class="sig-name descname"><span class="pre">tic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#tic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.tic" title="Link to this definition"></a></dt>
<dd><p>Start time recorder</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.commons.ticDiff">
<span class="sig-prename descclassname"><span class="pre">core.commons.</span></span><span class="sig-name descname"><span class="pre">ticDiff</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#ticDiff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.ticDiff" title="Link to this definition"></a></dt>
<dd><p>Start time recorder</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.commons.toc">
<span class="sig-prename descclassname"><span class="pre">core.commons.</span></span><span class="sig-name descname"><span class="pre">toc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tempBool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#toc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.toc" title="Link to this definition"></a></dt>
<dd><p>Print current time difference</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.commons.tocDiff">
<span class="sig-prename descclassname"><span class="pre">core.commons.</span></span><span class="sig-name descname"><span class="pre">tocDiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tempBool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/commons.html#tocDiff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.commons.tocDiff" title="Link to this definition"></a></dt>
<dd><p>Print current time difference</p>
</dd></dl>

</section>
<section id="module-core.jax_utils">
<span id="core-jax-utils-module"></span><h2>core.jax_utils module<a class="headerlink" href="#module-core.jax_utils" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.jax_utils.AgentState">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.jax_utils.</span></span><span class="sig-name descname"><span class="pre">AgentState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FrozenDict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GradientTransformation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">ArrayTree</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ArrayTree</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ibp_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/jax_utils.html#AgentState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.jax_utils.AgentState" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainState</span></code></p>
<p>Class inherited from the TrainState class from flax. 
It sets default values for agent functions to make TrainState work in jitted function.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="core.jax_utils.AgentState.ibp_fn">
<span class="sig-name descname"><span class="pre">ibp_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><a class="headerlink" href="#core.jax_utils.AgentState.ibp_fn" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.jax_utils.AgentState.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#core.jax_utils.AgentState.replace" title="Link to this definition"></a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="core.jax_utils.MLP">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.jax_utils.</span></span><span class="sig-name descname"><span class="pre">MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">features:</span> <span class="pre">~typing.Sequence[int],</span> <span class="pre">activation_func:</span> <span class="pre">list,</span> <span class="pre">parent:</span> <span class="pre">~flax.linen.module.Module</span> <span class="pre">|</span> <span class="pre">~flax.core.scope.Scope</span> <span class="pre">|</span> <span class="pre">~flax.linen.module._Sentinel</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object&gt;,</span> <span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/jax_utils.html#MLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.jax_utils.MLP" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Define multi-layer perception with JAX</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="core.jax_utils.MLP.activation_func">
<span class="sig-name descname"><span class="pre">activation_func</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#core.jax_utils.MLP.activation_func" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.jax_utils.MLP.features">
<span class="sig-name descname"><span class="pre">features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#core.jax_utils.MLP.features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.jax_utils.MLP.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#core.jax_utils.MLP.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.jax_utils.MLP.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_Sentinel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#core.jax_utils.MLP.parent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.jax_utils.MLP.scope">
<span class="sig-name descname"><span class="pre">scope</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#core.jax_utils.MLP.scope" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.jax_utils.MLP.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/jax_utils.html#MLP.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.jax_utils.MLP.setup" title="Link to this definition"></a></dt>
<dd><p>Initializes a Module lazily (similar to a lazy <code class="docutils literal notranslate"><span class="pre">__init__</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">setup</span></code> is called once lazily on a module instance when a module
is bound, immediately before any other methods like <code class="docutils literal notranslate"><span class="pre">__call__</span></code> are
invoked, or before a <code class="docutils literal notranslate"><span class="pre">setup</span></code>-defined attribute on <code class="docutils literal notranslate"><span class="pre">self</span></code> is accessed.</p>
<p>This can happen in three cases:</p>
<blockquote>
<div><ol class="arabic">
<li><p>Immediately when invoking <code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">init()</span></code> or
<code class="xref py py-meth docutils literal notranslate"><span class="pre">init_and_output()</span></code>.</p></li>
<li><p>Once the module is given a name by being assigned to an attribute of
another module inside the other module’s <code class="docutils literal notranslate"><span class="pre">setup</span></code> method
(see <code class="xref py py-meth docutils literal notranslate"><span class="pre">__setattr__()</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyModule</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">submodule</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

<span class="go">...     # Accessing `submodule` attributes does not yet work here.</span>

<span class="go">...     # The following line invokes `self.__setattr__`, which gives</span>
<span class="go">...     # `submodule` the name &quot;conv1&quot;.</span>
<span class="go">...     self.conv1 = submodule</span>

<span class="go">...     # Accessing `submodule` attributes or methods is now safe and</span>
<span class="go">...     # either causes setup() to be called once.</span>
</pre></div>
</div>
</li>
<li><p>Once a module is constructed inside a method wrapped with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">compact()</span></code>, immediately before another method is called or
<code class="docutils literal notranslate"><span class="pre">setup</span></code> defined attribute is accessed.</p></li>
</ol>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.jax_utils.apply_ibp_rectangular">
<span class="sig-prename descclassname"><span class="pre">core.jax_utils.</span></span><span class="sig-name descname"><span class="pre">apply_ibp_rectangular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">act_fns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/jax_utils.html#apply_ibp_rectangular"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.jax_utils.apply_ibp_rectangular" title="Link to this definition"></a></dt>
<dd><p>Implementation of the interval bound propagation (IBP) method from <a class="reference external" href="https://arxiv.org/abs/1810.12715">https://arxiv.org/abs/1810.12715</a>.
We use IBP to compute upper and lower bounds for (hyper)rectangular input sets.</p>
<p>This function returns the same result as jax_verify.interval_bound_propagation(apply_fn, initial_bounds). However,
the jax_verify version is generally slower, because it is written to handle more general neural networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>act_fns</strong> – List of flax.nn activation functions.</p></li>
<li><p><strong>params</strong> – Parameter dictionary of the network.</p></li>
<li><p><strong>mean</strong> – 2d array, with each row being an input point of dimension n.</p></li>
<li><p><strong>radius</strong> – 1d array, specifying the radius of the input in every dimension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>lb and ub (both 2d arrays of the same shape as <cite>mean</cite>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.jax_utils.create_batches">
<span class="sig-prename descclassname"><span class="pre">core.jax_utils.</span></span><span class="sig-name descname"><span class="pre">create_batches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/jax_utils.html#create_batches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.jax_utils.create_batches" title="Link to this definition"></a></dt>
<dd><p>Create batches for the given data and batch size. Returns the start and end indices to iterate over.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_length</strong> – Total number of data points.</p></li>
<li><p><strong>batch_size</strong> – Number of points per batch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Each batch is represented by the slice [starts[i]:ends[i]].</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.jax_utils.create_nn_states">
<span class="sig-prename descclassname"><span class="pre">core.jax_utils.</span></span><span class="sig-name descname"><span class="pre">create_nn_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Policy_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_neurons_withOut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_act_fn_withOut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi_neurons_per_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Policy_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0005</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/jax_utils.html#create_nn_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.jax_utils.create_nn_states" title="Link to this definition"></a></dt>
<dd><p>Create Jax state objects (for both policy and certificate).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Benchmark model.</p></li>
<li><p><strong>Policy_config</strong> – Configuration for policy.</p></li>
<li><p><strong>V_neurons_withOut</strong> – Number of neurons per layer of certificate network (including the output dimension).</p></li>
<li><p><strong>V_act_fn_withOut</strong> – Activation function per layer of certificate network (including the output act. func.).</p></li>
<li><p><strong>pi_neurons_per_layer</strong> – Number of neurons per layer of policy network (excluding the output dimension).</p></li>
<li><p><strong>Policy_lr</strong> – Policy network learning rate.</p></li>
<li><p><strong>V_lr</strong> – Certificate learning rate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>V_state: Initialized certificate network</p></li>
<li><p>Policy_state: Initialized policy network</p></li>
<li><p>Policy_config: Configuration for policy.</p></li>
<li><p>Policy_neurons_withOut: Number of neurons per layer of policy network (including the output dimension).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.jax_utils.create_train_state">
<span class="sig-prename descclassname"><span class="pre">core.jax_utils.</span></span><span class="sig-name descname"><span class="pre">create_train_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_funcs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/jax_utils.html#create_train_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.jax_utils.create_train_state" title="Link to this definition"></a></dt>
<dd><p>Create a flax TrainState object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – MLP object describing number of neurons per layer and the activation functions.</p></li>
<li><p><strong>act_funcs</strong> – List of activation functions (required separately for the IBP function).</p></li>
<li><p><strong>rng</strong> – random number generator object.</p></li>
<li><p><strong>in_dim</strong> – Input dimension of the network.</p></li>
<li><p><strong>learning_rate</strong> – Learning rate.</p></li>
<li><p><strong>ema</strong> – Rate of the EMA (exponential moving average) used in the optimizer.</p></li>
<li><p><strong>params</strong> – Additional parameters to be passed to the (flax) TrainState class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>flax TrainState object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.jax_utils.lipschitz_coeff">
<span class="sig-prename descclassname"><span class="pre">core.jax_utils.</span></span><span class="sig-name descname"><span class="pre">lipschitz_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CPLip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Linfty</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/jax_utils.html#lipschitz_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.jax_utils.lipschitz_coeff" title="Link to this definition"></a></dt>
<dd><p>Function to compute Lipschitz constants using the techniques presented in the paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> – Neural network parameters.</p></li>
<li><p><strong>weighted</strong> – If true, use weighted norms.</p></li>
<li><p><strong>CPLip</strong> – If true, use the average activation operators (cplip) improvement.</p></li>
<li><p><strong>Linfty</strong> – If true, use Linfty norm; If false, use L1 norm (currently only L1 norm is used).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Lipschitz constant and list of weights (or None if weighted is False).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.jax_utils.load_policy_config">
<span class="sig-prename descclassname"><span class="pre">core.jax_utils.</span></span><span class="sig-name descname"><span class="pre">load_policy_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/jax_utils.html#load_policy_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.jax_utils.load_policy_config" title="Link to this definition"></a></dt>
<dd><p>Load the configuration of a saved neural network checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint_path</strong> – file path to a Orbax checkpoint file.</p></li>
<li><p><strong>key</strong> – string ‘V_config’ or ‘Policy_config’, describing whether the certificate or the policy should be loaded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary, giving the relevant configuration.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.jax_utils.orbax_parse_activation_fn">
<span class="sig-prename descclassname"><span class="pre">core.jax_utils.</span></span><span class="sig-name descname"><span class="pre">orbax_parse_activation_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">activation_fn_txt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/jax_utils.html#orbax_parse_activation_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.jax_utils.orbax_parse_activation_fn" title="Link to this definition"></a></dt>
<dd><p>Parse list of activation functions as flax functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>activation_fn_txt</strong> – List of strings describing the activation functions.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of flax functions describing the activation functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.jax_utils.orbax_set_config">
<span class="sig-prename descclassname"><span class="pre">core.jax_utils.</span></span><span class="sig-name descname"><span class="pre">orbax_set_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_datetime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RL_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neurons_per_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_fn_txt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/jax_utils.html#orbax_set_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.jax_utils.orbax_set_config" title="Link to this definition"></a></dt>
<dd><p>Set configuration of Orbax neural network checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_datetime</strong> – Time at which training was started.</p></li>
<li><p><strong>env_name</strong> – Name of the environment.</p></li>
<li><p><strong>layout</strong> – Layout of the environment.</p></li>
<li><p><strong>seed</strong> – Random seed used.</p></li>
<li><p><strong>RL_method</strong> – RL algorithm that was used for the pretraining.</p></li>
<li><p><strong>total_steps</strong> – Number of steps for which the network was (pre)trained.</p></li>
<li><p><strong>neurons_per_layer</strong> – Number of neurons per layer of the network.</p></li>
<li><p><strong>activation_fn_txt</strong> – List of strings describing the activation functions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>configuration dictionary</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-core.learner">
<span id="core-learner-module"></span><h2>core.learner module<a class="headerlink" href="#module-core.learner" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.learner.Learner">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.learner.</span></span><span class="sig-name descname"><span class="pre">Learner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/learner.html#Learner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.learner.Learner" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Main learner class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="core.learner.Learner.debug_train_step">
<span class="sig-name descname"><span class="pre">debug_train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples_in_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/learner.html#Learner.debug_train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.learner.Learner.debug_train_step" title="Link to this definition"></a></dt>
<dd><p>Debug function for the training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Command line arguments given.</p></li>
<li><p><strong>samples_in_batch</strong> – Dictionary, giving the samples used in the batch per category.</p></li>
<li><p><strong>iteration</strong> – Number of the CEGIS iteration.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.learner.Learner.loss_exp_decrease">
<span class="sig-name descname"><span class="pre">loss_exp_decrease</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probability_bound</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/learner.html#Learner.loss_exp_decrease"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.learner.Learner.loss_exp_decrease" title="Link to this definition"></a></dt>
<dd><p>Compute expected certificate value in the new state for the loss related to condition 3 (expected decrease).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V_state</strong> – Certificate neural network.</p></li>
<li><p><strong>V_params</strong> – Parameters of the certificate neural network.</p></li>
<li><p><strong>x</strong> – State.</p></li>
<li><p><strong>u</strong> – Action.</p></li>
<li><p><strong>noise_key</strong> – key of the random number generator.</p></li>
<li><p><strong>probability_bound</strong> – The probability bound of the specification that we aim to certify.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Expected certificate value in the new state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.learner.Learner.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TrainState</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Policy_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TrainState</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">counterexamples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probability_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expDecr_multiplier</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/learner.html#Learner.train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.learner.Learner.train_step" title="Link to this definition"></a></dt>
<dd><p>Perform one step of training the neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – key of the random number generator.</p></li>
<li><p><strong>V_state</strong> – Certificate network.</p></li>
<li><p><strong>Policy_state</strong> – Policy network.</p></li>
<li><p><strong>counterexamples</strong> – Current list of counterexamples.</p></li>
<li><p><strong>mesh_loss</strong> – float, determining the largest mesh for which a loss of 0 implies that the condition is satisfied.</p></li>
<li><p><strong>probability_bound</strong> – The probability bound of the specification that we aim to certify.</p></li>
<li><p><strong>expDecr_multiplier</strong> – Multiplier of the expected decrease loss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>V_grads: Gradients of the certificate network.</p></li>
<li><p>Policy_grads: Gradients of the policy network.</p></li>
<li><p>infos: Dictionary, giving the total loss as well as each component (total, init, unsafe, expDecrease_mean, expDecrease_max (not used), Lipschitz (not used)).</p></li>
<li><p>key: key of the random number generator.</p></li>
<li><p>samples_in_batch: Dictionary, giving the samples used in the batch per category.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-core.logger">
<span id="core-logger-module"></span><h2>core.logger module<a class="headerlink" href="#module-core.logger" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.logger.Logger">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.logger.</span></span><span class="sig-name descname"><span class="pre">Logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round_decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/logger.html#Logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.logger.Logger" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to export results to csv files</p>
<dl class="py method">
<dt class="sig sig-object py" id="core.logger.Logger.add_info">
<span class="sig-name descname"><span class="pre">add_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/logger.html#Logger.add_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.logger.Logger.add_info" title="Link to this definition"></a></dt>
<dd><p>Add single element to info dictionary</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.logger.Logger.add_info_from_dict">
<span class="sig-name descname"><span class="pre">add_info_from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/logger.html#Logger.add_info_from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.logger.Logger.add_info_from_dict" title="Link to this definition"></a></dt>
<dd><p>Add info from a dictionary</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.logger.Logger.append_Lipschitz">
<span class="sig-name descname"><span class="pre">append_Lipschitz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Policy_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/logger.html#Logger.append_Lipschitz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.logger.Logger.append_Lipschitz" title="Link to this definition"></a></dt>
<dd><p>Calculate and export Lipschitz constants of the policy and certificate networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Policy_state</strong> – Policy neural network.</p></li>
<li><p><strong>V_state</strong> – Certificate neural network.</p></li>
<li><p><strong>iteration</strong> – Number of the CEGIS iteration.</p></li>
<li><p><strong>silent</strong> – If False, Lipschitz constants are also printed to stdout.</p></li>
<li><p><strong>export</strong> – If True, export Lipschitz constants to a csv file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.logger.Logger.append_time">
<span class="sig-name descname"><span class="pre">append_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/logger.html#Logger.append_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.logger.Logger.append_time" title="Link to this definition"></a></dt>
<dd><p>Store and export timing statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – string (describing a part of the algorithm)</p></li>
<li><p><strong>value</strong> – time spent in a part of the algorithm.</p></li>
<li><p><strong>export</strong> – If True, export timings to a csv file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.logger.Logger.export_Lipschitz">
<span class="sig-name descname"><span class="pre">export_Lipschitz</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/logger.html#Logger.export_Lipschitz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.logger.Logger.export_Lipschitz" title="Link to this definition"></a></dt>
<dd><p>Export Lipschitz constants to csv</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.logger.Logger.export_args">
<span class="sig-name descname"><span class="pre">export_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/logger.html#Logger.export_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.logger.Logger.export_args" title="Link to this definition"></a></dt>
<dd><p>Exports all arguments to a csv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – Command line arguments given.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.logger.Logger.export_info">
<span class="sig-name descname"><span class="pre">export_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/logger.html#Logger.export_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.logger.Logger.export_info" title="Link to this definition"></a></dt>
<dd><p>Export info to csv</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.logger.Logger.export_times">
<span class="sig-name descname"><span class="pre">export_times</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/logger.html#Logger.export_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.logger.Logger.export_times" title="Link to this definition"></a></dt>
<dd><p>Export times to csv</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.logger.Logger.get_timer_value">
<span class="sig-name descname"><span class="pre">get_timer_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/logger.html#Logger.get_timer_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.logger.Logger.get_timer_value" title="Link to this definition"></a></dt>
<dd><p>Compute time elapsed since time was last stored. If reset=True, then the timer is reset afterward.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.logger.Logger.set_timer">
<span class="sig-name descname"><span class="pre">set_timer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/logger.html#Logger.set_timer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.logger.Logger.set_timer" title="Link to this definition"></a></dt>
<dd><p>Store current time.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-core.parse_args">
<span id="core-parse-args-module"></span><h2>core.parse_args module<a class="headerlink" href="#module-core.parse_args" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="core.parse_args.parse_arguments">
<span class="sig-prename descclassname"><span class="pre">core.parse_args.</span></span><span class="sig-name descname"><span class="pre">parse_arguments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">linfty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datetime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cwd</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/parse_args.html#parse_arguments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.parse_args.parse_arguments" title="Link to this definition"></a></dt>
<dd><p>Function to parse arguments provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>linfty</strong> – If True, use L_infty norms for Lipschitz constants.</p></li>
<li><p><strong>datetime</strong> – Current datetime.</p></li>
<li><p><strong>cwd</strong> – Current working directory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Arguments object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.parse_args.set_mesh_loss">
<span class="sig-prename descclassname"><span class="pre">core.parse_args.</span></span><span class="sig-name descname"><span class="pre">set_mesh_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recommended_tauK</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/parse_args.html#set_mesh_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.parse_args.set_mesh_loss" title="Link to this definition"></a></dt>
<dd><p>Set the mesh / tau for the learner loss function, either based on the specified tau*K value or the value of tau directly</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Command line arguments given.</p></li>
<li><p><strong>env</strong> – Environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-core.plot">
<span id="core-plot-module"></span><h2>core.plot module<a class="headerlink" href="#module-core.plot" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="core.plot.plot_boxes">
<span class="sig-prename descclassname"><span class="pre">core.plot.</span></span><span class="sig-name descname"><span class="pre">plot_boxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_dimensions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/plot.html#plot_boxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.plot.plot_boxes" title="Link to this definition"></a></dt>
<dd><p>Plot the target, initial, and unsafe state sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment</p></li>
<li><p><strong>ax</strong> – A matplotlib figure.</p></li>
<li><p><strong>plot_dimensions</strong> – List of length two, mentioning which of the dimensions of the state space to plot.</p></li>
<li><p><strong>labels</strong> – boolean. If true, add labels to the axes.</p></li>
<li><p><strong>latex</strong> – boolean. If true, use LaTeX for the labels of the axes.</p></li>
<li><p><strong>size</strong> – integer. Size of the axis labels.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.plot.plot_certificate_2D">
<span class="sig-prename descclassname"><span class="pre">core.plot.</span></span><span class="sig-name descname"><span class="pre">plot_certificate_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cert_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/plot.html#plot_certificate_2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.plot.plot_certificate_2D" title="Link to this definition"></a></dt>
<dd><p>Plot the given RASM as a 2D heatmap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>cert_state</strong> – Certificate network.</p></li>
<li><p><strong>folder</strong> – boolean or string. If not false, should be the pathname of the folder where to save the plot.</p></li>
<li><p><strong>filename</strong> – boolean or string. If not false, should be the filename on which the plot should be saved.</p></li>
<li><p><strong>logscale</strong> – boolean. If true, use a logarithmic scale.</p></li>
<li><p><strong>title</strong> – boolean. If true, add a title.</p></li>
<li><p><strong>labels</strong> – boolean. If true, add labels to the axes.</p></li>
<li><p><strong>resolution</strong> – integer. Number of points used for the heatmap in each dimension.</p></li>
<li><p><strong>latex</strong> – boolean. If true, use LaTeX for the labels of the axes.</p></li>
<li><p><strong>size</strong> – integer. Size of the axis labels.</p></li>
<li><p><strong>contour</strong> – boolean. If true, plot contour lines.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.plot.plot_dataset">
<span class="sig-prename descclassname"><span class="pre">core.plot.</span></span><span class="sig-name descname"><span class="pre">plot_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/plot.html#plot_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.plot.plot_dataset" title="Link to this definition"></a></dt>
<dd><p>Plot the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>train_data</strong> – Data points used in the training, to be plotted in black.</p></li>
<li><p><strong>additional_data</strong> – Additional data, to be plotted in blue (used for, e.g., counterexamples or hard violations).</p></li>
<li><p><strong>folder</strong> – boolean or string. If not false, should be the pathname of the folder where to save the plot.</p></li>
<li><p><strong>filename</strong> – boolean or string. If not false, should be the filename on which the plot should be saved.</p></li>
<li><p><strong>title</strong> – boolean. If true, add a title.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.plot.plot_heatmap">
<span class="sig-prename descclassname"><span class="pre">core.plot.</span></span><span class="sig-name descname"><span class="pre">plot_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/plot.html#plot_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.plot.plot_heatmap" title="Link to this definition"></a></dt>
<dd><p>Generitc function to plot a heatmap for the given coordinates and values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>coordinates</strong> – List of coordinates for which a value is given.</p></li>
<li><p><strong>values</strong> – List of the values corresponding to the coordinates.</p></li>
<li><p><strong>folder</strong> – boolean or string. If not false, should be the pathname of the folder where to save the plot.</p></li>
<li><p><strong>filename</strong> – boolean or string. If not false, should be the filename on which the plot should be saved.</p></li>
<li><p><strong>title</strong> – boolean. If true, add a title.</p></li>
<li><p><strong>size</strong> – integer. Size of the axis labels.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.plot.plot_layout">
<span class="sig-prename descclassname"><span class="pre">core.plot.</span></span><span class="sig-name descname"><span class="pre">plot_layout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/plot.html#plot_layout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.plot.plot_layout" title="Link to this definition"></a></dt>
<dd><p>Plot the layout of the reach-avoid specification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>folder</strong> – boolean or string. If not false, should be the pathname of the folder where to save the plot.</p></li>
<li><p><strong>filename</strong> – boolean or string. If not false, should be the filename on which the plot should be saved.</p></li>
<li><p><strong>title</strong> – boolean. If true, add a title.</p></li>
<li><p><strong>latex</strong> – boolean. If true, use LaTeX for the labels of the axes.</p></li>
<li><p><strong>size</strong> – integer. Size of the axis labels.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.plot.plot_traces">
<span class="sig-prename descclassname"><span class="pre">core.plot.</span></span><span class="sig-name descname"><span class="pre">plot_traces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Policy_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/plot.html#plot_traces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.plot.plot_traces" title="Link to this definition"></a></dt>
<dd><p>Plot simulated traces under the given policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>Policy_state</strong> – Policy network.</p></li>
<li><p><strong>key</strong> – random number generator key.</p></li>
<li><p><strong>num_traces</strong> – Number of traces to be plotted.</p></li>
<li><p><strong>len_traces</strong> – Number of environment steps done per trace.</p></li>
<li><p><strong>folder</strong> – boolean or string. If not false, should be the pathname of the folder where to save the plot.</p></li>
<li><p><strong>filename</strong> – boolean or string. If not false, should be the filename on which the plot should be saved.</p></li>
<li><p><strong>title</strong> – boolean. If true, add a title.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Numpy array containing the traces.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.plot.position_fraction">
<span class="sig-prename descclassname"><span class="pre">core.plot.</span></span><span class="sig-name descname"><span class="pre">position_fraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/plot.html#position_fraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.plot.position_fraction" title="Link to this definition"></a></dt>
<dd><p>Calculate the relative position at which the given point is, within the box [lb, ub]. 
For example, the point point=0.5 is at a fraction of 0.95 within [-1.4, 0.6].
Note that the answer is between 0 and 1 if and only if the point is inside [lb, ub].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point</strong> – Float, the input point.</p></li>
<li><p><strong>lb</strong> – Float, the input lower bound.</p></li>
<li><p><strong>ub</strong> – Float, the input upper bound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float, the relative position of point in the box [lb, ub].</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.plot.position_in_heatmap">
<span class="sig-prename descclassname"><span class="pre">core.plot.</span></span><span class="sig-name descname"><span class="pre">position_in_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmap_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/plot.html#position_in_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.plot.position_in_heatmap" title="Link to this definition"></a></dt>
<dd><p>Calculate where the given point is located in a heatmap. 
Note that in a heatmap, the upper left corner is (0,0), while in normal plots, the bottom left corner is (0,0).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point</strong> – Float, the input point.</p></li>
<li><p><strong>lb</strong> – Float, the input lower bound.</p></li>
<li><p><strong>ub</strong> – Float, the input upper bound.</p></li>
<li><p><strong>heatmap_size</strong> – The upper limits of the heatmap.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The position on the heatmap.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.plot.vector_plot">
<span class="sig-prename descclassname"><span class="pre">core.plot.</span></span><span class="sig-name descname"><span class="pre">vector_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pi_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectors_per_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/plot.html#vector_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.plot.vector_plot" title="Link to this definition"></a></dt>
<dd><p>Create vector plot of the closed-loop dynamics under the given policy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>Pi_state</strong> – Policy network.</p></li>
<li><p><strong>vectors_per_dim</strong> – Number of vectors in the vector plot in each dimension.</p></li>
<li><p><strong>seed</strong> – Seed used for computing the next state.</p></li>
<li><p><strong>folder</strong> – boolean or string. If not false, should be the pathname of the folder where to save the plot.</p></li>
<li><p><strong>filename</strong> – boolean or string. If not false, should be the filename on which the plot should be saved.</p></li>
<li><p><strong>title</strong> – boolean. If true, add a title.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-core.ppo_jax">
<span id="core-ppo-jax-module"></span><h2>core.ppo_jax module<a class="headerlink" href="#module-core.ppo_jax" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.ppo_jax.Actor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">Actor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_shape_prod:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neurons_per_layer:</span> <span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_func:</span> <span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent:</span> <span class="pre">~flax.linen.module.Module</span> <span class="pre">|</span> <span class="pre">~flax.core.scope.Scope</span> <span class="pre">|</span> <span class="pre">~flax.linen.module._Sentinel</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#Actor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.Actor" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Actor class.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Actor.action_shape_prod">
<span class="sig-name descname"><span class="pre">action_shape_prod</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#core.ppo_jax.Actor.action_shape_prod" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Actor.activation_func">
<span class="sig-name descname"><span class="pre">activation_func</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#core.ppo_jax.Actor.activation_func" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Actor.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#core.ppo_jax.Actor.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Actor.neurons_per_layer">
<span class="sig-name descname"><span class="pre">neurons_per_layer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#core.ppo_jax.Actor.neurons_per_layer" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Actor.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_Sentinel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#core.ppo_jax.Actor.parent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Actor.scope">
<span class="sig-name descname"><span class="pre">scope</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#core.ppo_jax.Actor.scope" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="core.ppo_jax.AgentParams">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">AgentParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actor_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">critic_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#AgentParams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.AgentParams" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class storing parameters for the PPO actor-critic.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.AgentParams.actor_params">
<span class="sig-name descname"><span class="pre">actor_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#core.ppo_jax.AgentParams.actor_params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.AgentParams.critic_params">
<span class="sig-name descname"><span class="pre">critic_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#core.ppo_jax.AgentParams.critic_params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.ppo_jax.AgentParams.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#core.ppo_jax.AgentParams.replace" title="Link to this definition"></a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="core.ppo_jax.AgentState">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">AgentState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FrozenDict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GradientTransformation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">ArrayTree</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ArrayTree</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actor_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">critic_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#AgentState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.AgentState" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainState</span></code></p>
<p>Class inherited from the TrainState class from flax. 
It sets default values for agent functions to make TrainState work in jitted function.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.AgentState.actor_fn">
<span class="sig-name descname"><span class="pre">actor_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><a class="headerlink" href="#core.ppo_jax.AgentState.actor_fn" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.AgentState.critic_fn">
<span class="sig-name descname"><span class="pre">critic_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><a class="headerlink" href="#core.ppo_jax.AgentState.critic_fn" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.ppo_jax.AgentState.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#core.ppo_jax.AgentState.replace" title="Link to this definition"></a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="core.ppo_jax.Critic">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">Critic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neurons_per_layer:</span> <span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_func:</span> <span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent:</span> <span class="pre">~flax.linen.module.Module</span> <span class="pre">|</span> <span class="pre">~flax.core.scope.Scope</span> <span class="pre">|</span> <span class="pre">~flax.linen.module._Sentinel</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#Critic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.Critic" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Critic class.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Critic.activation_func">
<span class="sig-name descname"><span class="pre">activation_func</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#core.ppo_jax.Critic.activation_func" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Critic.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#core.ppo_jax.Critic.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Critic.neurons_per_layer">
<span class="sig-name descname"><span class="pre">neurons_per_layer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#core.ppo_jax.Critic.neurons_per_layer" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Critic.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_Sentinel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#core.ppo_jax.Critic.parent" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Critic.scope">
<span class="sig-name descname"><span class="pre">scope</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#core.ppo_jax.Critic.scope" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="core.ppo_jax.EpisodeStatistics">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">EpisodeStatistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episode_returns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episode_lengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returned_episode_returns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returned_episode_lengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#EpisodeStatistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.EpisodeStatistics" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class storing statistics of the episode.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.EpisodeStatistics.episode_lengths">
<span class="sig-name descname"><span class="pre">episode_lengths</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#core.ppo_jax.EpisodeStatistics.episode_lengths" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.EpisodeStatistics.episode_returns">
<span class="sig-name descname"><span class="pre">episode_returns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#core.ppo_jax.EpisodeStatistics.episode_returns" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.ppo_jax.EpisodeStatistics.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#core.ppo_jax.EpisodeStatistics.replace" title="Link to this definition"></a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.EpisodeStatistics.returned_episode_lengths">
<span class="sig-name descname"><span class="pre">returned_episode_lengths</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#core.ppo_jax.EpisodeStatistics.returned_episode_lengths" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.EpisodeStatistics.returned_episode_returns">
<span class="sig-name descname"><span class="pre">returned_episode_returns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#core.ppo_jax.EpisodeStatistics.returned_episode_returns" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.ppo_jax.PPO">
<span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">PPO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">env,</span> <span class="pre">env_name,</span> <span class="pre">cwd,</span> <span class="pre">args,</span> <span class="pre">max_policy_lipschitz,</span> <span class="pre">neurons_per_layer=[64,</span> <span class="pre">64],</span> <span class="pre">activation_functions_jax=[&lt;jax._src.custom_derivatives.custom_jvp</span> <span class="pre">object&gt;,</span> <span class="pre">&lt;jax._src.custom_derivatives.custom_jvp</span> <span class="pre">object&gt;],</span> <span class="pre">activation_functions_txt=['relu',</span> <span class="pre">'relu'],</span> <span class="pre">verbose=False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#PPO"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.PPO" title="Link to this definition"></a></dt>
<dd><p>Function for PPO pretraining of policies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>env_name</strong> – string, the name of the environment.</p></li>
<li><p><strong>cwd</strong> – Current working directory (used for saving the checkpoint).</p></li>
<li><p><strong>args</strong> – Parameters for the PPO pretraining. (Note: these can differ from the global command line arguments)</p></li>
<li><p><strong>max_policy_lipschitz</strong> – Limit on the policy Lipschitz constant, above which a cost is incurred.</p></li>
<li><p><strong>neurons_per_layer</strong> – List of ints, giving the number of neurons per layer.</p></li>
<li><p><strong>activation_functions_jax</strong> – List of flax activation functions.</p></li>
<li><p><strong>activation_functions_txt</strong> – List of strings, giving the name of the activation functions.</p></li>
<li><p><strong>verbose</strong> – If true, print more information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>agent_state: AgentState object.</p></li>
<li><p>Policy_state: Policy network.</p></li>
<li><p>checkpoint_path: path to the saved checkpoint.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">PPOargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_timesteps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_envs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anneal_lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gae_lambda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_minibatches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_coef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ent_coef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vf_coef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grad_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cplip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linfty</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#PPOargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.PPOargs" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.anneal_lr">
<span class="sig-name descname"><span class="pre">anneal_lr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.anneal_lr" title="Link to this definition"></a></dt>
<dd><p>Toggle learning rate annealing for policy and value networks</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.batch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.clip_coef">
<span class="sig-name descname"><span class="pre">clip_coef</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.clip_coef" title="Link to this definition"></a></dt>
<dd><p>the surrogate clipping coefficient</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.cplip">
<span class="sig-name descname"><span class="pre">cplip</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.cplip" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.ent_coef">
<span class="sig-name descname"><span class="pre">ent_coef</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.ent_coef" title="Link to this definition"></a></dt>
<dd><p>coefficient of the entropy</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.gae_lambda">
<span class="sig-name descname"><span class="pre">gae_lambda</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.gae_lambda" title="Link to this definition"></a></dt>
<dd><p>the lambda for the general advantage estimation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.gamma">
<span class="sig-name descname"><span class="pre">gamma</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.gamma" title="Link to this definition"></a></dt>
<dd><p>the discount factor gamma</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.high_precision">
<span class="sig-name descname"><span class="pre">high_precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.high_precision" title="Link to this definition"></a></dt>
<dd><p>Toggle for using 64-bit vs. 32-bit in JAX</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.layout">
<span class="sig-name descname"><span class="pre">layout</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.layout" title="Link to this definition"></a></dt>
<dd><p>layout argument for the environment</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.learning_rate">
<span class="sig-name descname"><span class="pre">learning_rate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.learning_rate" title="Link to this definition"></a></dt>
<dd><p>the learning rate of the optimizer</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.linfty">
<span class="sig-name descname"><span class="pre">linfty</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.linfty" title="Link to this definition"></a></dt>
<dd><p>settings for the Lipschitz constant</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.max_grad_norm">
<span class="sig-name descname"><span class="pre">max_grad_norm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.max_grad_norm" title="Link to this definition"></a></dt>
<dd><p>the maximum norm for the gradient clipping</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.minibatch_size">
<span class="sig-name descname"><span class="pre">minibatch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.minibatch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.num_envs">
<span class="sig-name descname"><span class="pre">num_envs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.num_envs" title="Link to this definition"></a></dt>
<dd><p>the number of parallel game environments</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.num_iterations">
<span class="sig-name descname"><span class="pre">num_iterations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.num_iterations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.num_minibatches">
<span class="sig-name descname"><span class="pre">num_minibatches</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.num_minibatches" title="Link to this definition"></a></dt>
<dd><p>the number of mini-batches</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.num_steps">
<span class="sig-name descname"><span class="pre">num_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.num_steps" title="Link to this definition"></a></dt>
<dd><p>the number of steps to run in each environment per policy rollout</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#core.ppo_jax.PPOargs.replace" title="Link to this definition"></a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.seed" title="Link to this definition"></a></dt>
<dd><p>seed of the experiment</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.total_timesteps">
<span class="sig-name descname"><span class="pre">total_timesteps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.total_timesteps" title="Link to this definition"></a></dt>
<dd><p>total timesteps of the experiments</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.update_epochs">
<span class="sig-name descname"><span class="pre">update_epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.update_epochs" title="Link to this definition"></a></dt>
<dd><p>the K epochs to update the policy</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.vf_coef">
<span class="sig-name descname"><span class="pre">vf_coef</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.vf_coef" title="Link to this definition"></a></dt>
<dd><p>coefficient of the value function</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.PPOargs.weighted">
<span class="sig-name descname"><span class="pre">weighted</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#core.ppo_jax.PPOargs.weighted" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="core.ppo_jax.Storage">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">Storage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logprobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dones</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">advantages</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#Storage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.Storage" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class storing data collected in episodes (rollouts/simulations in the environment).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Storage.actions">
<span class="sig-name descname"><span class="pre">actions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#core.ppo_jax.Storage.actions" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Storage.advantages">
<span class="sig-name descname"><span class="pre">advantages</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#core.ppo_jax.Storage.advantages" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Storage.dones">
<span class="sig-name descname"><span class="pre">dones</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#core.ppo_jax.Storage.dones" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Storage.logprobs">
<span class="sig-name descname"><span class="pre">logprobs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#core.ppo_jax.Storage.logprobs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Storage.obs">
<span class="sig-name descname"><span class="pre">obs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#core.ppo_jax.Storage.obs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.ppo_jax.Storage.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#core.ppo_jax.Storage.replace" title="Link to this definition"></a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Storage.returns">
<span class="sig-name descname"><span class="pre">returns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#core.ppo_jax.Storage.returns" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Storage.rewards">
<span class="sig-name descname"><span class="pre">rewards</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#core.ppo_jax.Storage.rewards" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="core.ppo_jax.Storage.values">
<span class="sig-name descname"><span class="pre">values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#core.ppo_jax.Storage.values" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.ppo_jax.compute_gae">
<span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">compute_gae</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.PPOargs" title="core.ppo_jax.PPOargs"><span class="pre">PPOargs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TrainState</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.Storage" title="core.ppo_jax.Storage"><span class="pre">Storage</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#compute_gae"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.compute_gae" title="Link to this definition"></a></dt>
<dd><p>Computes the Gradient Advantage Estimator (GAE).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Parameters for the PPO pretraining. (Note: these can differ from the global command line arguments)</p></li>
<li><p><strong>agent_state</strong> – AgentState (flax TrainState) object.</p></li>
<li><p><strong>next_obs</strong> – Next observation.</p></li>
<li><p><strong>next_done</strong> – 1 if this is the last step in the episode, 0 otherwise</p></li>
<li><p><strong>storage</strong> – Storage storing data collected in episodes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated storage.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.ppo_jax.compute_gae_body">
<span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">compute_gae_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#compute_gae_body"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.compute_gae_body" title="Link to this definition"></a></dt>
<dd><p>Computes the Gradient Advantage Estimator (GAE).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – number of remaining steps.</p></li>
<li><p><strong>val</strong> – tuple containing PPO arguments, data storage, and GAE.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>updated tuple containing PPO arguments, data storage and updated GAE.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.ppo_jax.compute_gae_jit">
<span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">compute_gae_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.PPOargs" title="core.ppo_jax.PPOargs"><span class="pre">PPOargs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.AgentState" title="core.ppo_jax.AgentState"><span class="pre">AgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.Storage" title="core.ppo_jax.Storage"><span class="pre">Storage</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#compute_gae_jit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.compute_gae_jit" title="Link to this definition"></a></dt>
<dd><p>Computes the Gradient Advantage Estimator (GAE). (jitted function)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Parameters for the PPO pretraining. (Note: these can differ from the global command line arguments)</p></li>
<li><p><strong>agent_state</strong> – AgentState (flax TrainState) object.</p></li>
<li><p><strong>next_obs</strong> – Next observation.</p></li>
<li><p><strong>next_done</strong> – 1 if this is the last step in the episode, 0 otherwise.</p></li>
<li><p><strong>storage</strong> – Storage storing data collected in episodes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated storage.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.ppo_jax.get_action_and_value">
<span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">get_action_and_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.AgentState" title="core.ppo_jax.AgentState"><span class="pre">AgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.Storage" title="core.ppo_jax.Storage"><span class="pre">Storage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#get_action_and_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.get_action_and_value" title="Link to this definition"></a></dt>
<dd><p>Sample an action and update storage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – AgentState (flax TrainState) object.</p></li>
<li><p><strong>next_obs</strong> – Next observation.</p></li>
<li><p><strong>next_done</strong> – 1 if this is the last step in the episode, 0 otherwise.</p></li>
<li><p><strong>storage</strong> – Storage storing data collected in episodes.</p></li>
<li><p><strong>step</strong> – Index of the step used to update the storage.</p></li>
<li><p><strong>key</strong> – random number generator key</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>storage: Updated storage.</p></li>
<li><p>action: Sampled action.</p></li>
<li><p>key: random number generator key</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.ppo_jax.get_action_and_value2">
<span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">get_action_and_value2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.AgentState" title="core.ppo_jax.AgentState"><span class="pre">AgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.AgentParams" title="core.ppo_jax.AgentParams"><span class="pre">AgentParams</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#get_action_and_value2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.get_action_and_value2" title="Link to this definition"></a></dt>
<dd><p>Construct action distribution and return some statistics and the value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent_state</strong> – AgentState (flax TrainState) object.</p></li>
<li><p><strong>params</strong> – Parameters of the actor and critic networks.</p></li>
<li><p><strong>obs</strong> – Input observation.</p></li>
<li><p><strong>action</strong> – Input action.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Summed log probabilities corresponding to the action probabilities.</p></li>
<li><p>Summed entropies corresponding to the action probabilities.</p></li>
<li><p>Values provided by the critic.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.ppo_jax.linear_layer_init">
<span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">linear_layer_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.float64(1.4142135623730951)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_const</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#linear_layer_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.linear_layer_init" title="Link to this definition"></a></dt>
<dd><p>Helper function to quickly declare linear layer with weight and bias initializers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – Number of neurons.</p></li>
<li><p><strong>std</strong> – Scale for the orthogonal matrix initializers.</p></li>
<li><p><strong>bias_const</strong> – Initialization for the bias.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Linear neural network layer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.ppo_jax.rollout_jax">
<span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">rollout_jax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.PPOargs" title="core.ppo_jax.PPOargs"><span class="pre">PPOargs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.AgentState" title="core.ppo_jax.AgentState"><span class="pre">AgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.Storage" title="core.ppo_jax.Storage"><span class="pre">Storage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_since_reset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#rollout_jax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.rollout_jax" title="Link to this definition"></a></dt>
<dd><p>Perform a rollout.  (non-jitted function)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>args</strong> – Parameters for the PPO pretraining. (Note: these can differ from the global command line arguments)</p></li>
<li><p><strong>agent_state</strong> – AgentState (flax TrainState) object.</p></li>
<li><p><strong>next_obs</strong> – Next observation.</p></li>
<li><p><strong>next_done</strong> – 1 if this is the last step in the episode, 0 otherwise.</p></li>
<li><p><strong>storage</strong> – Storage storing data collected in episodes.</p></li>
<li><p><strong>action_key</strong> – random number generator key.</p></li>
<li><p><strong>env_key</strong> – random number generator key.</p></li>
<li><p><strong>steps_since_reset</strong> – Number of steps since the environment was reset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>next_obs: Next observation.</p></li>
<li><p>next_done: 1 if this is the last step in the episode, 0 otherwise.</p></li>
<li><p>storage: Storage storing data collected in episodes.</p></li>
<li><p>action_key: random number generator key.</p></li>
<li><p>env_key: random number generator key.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.ppo_jax.rollout_jax_jit">
<span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">rollout_jax_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.PPOargs" title="core.ppo_jax.PPOargs"><span class="pre">PPOargs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.AgentState" title="core.ppo_jax.AgentState"><span class="pre">AgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.Storage" title="core.ppo_jax.Storage"><span class="pre">Storage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_since_reset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#rollout_jax_jit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.rollout_jax_jit" title="Link to this definition"></a></dt>
<dd><p>Perform a rollout.  (jitted function)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>args</strong> – Parameters for the PPO pretraining. (Note: these can differ from the global command line arguments)</p></li>
<li><p><strong>agent_state</strong> – AgentState (flax TrainState) object.</p></li>
<li><p><strong>next_obs</strong> – Next observation.</p></li>
<li><p><strong>next_done</strong> – 1 if this is the last step in the episode, 0 otherwise.</p></li>
<li><p><strong>storage</strong> – Storage storing data collected in episodes.</p></li>
<li><p><strong>action_key</strong> – random number generator key</p></li>
<li><p><strong>env_key</strong> – random number generator key</p></li>
<li><p><strong>steps_since_reset</strong> – Number of steps since the environment was reset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>next_obs: Next observation.</p></li>
<li><p>next_done: 1 if this is the last step in the episode, 0 otherwise.</p></li>
<li><p>storage: Storage storing data collected in episodes.</p></li>
<li><p>action_key: random number generator key.</p></li>
<li><p>env_key: random number generator key.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.ppo_jax.update_ppo">
<span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">update_ppo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.PPOargs" title="core.ppo_jax.PPOargs"><span class="pre">PPOargs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.AgentState" title="core.ppo_jax.AgentState"><span class="pre">AgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.Storage" title="core.ppo_jax.Storage"><span class="pre">Storage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_policy_lipschitz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#update_ppo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.update_ppo" title="Link to this definition"></a></dt>
<dd><p>Update PPO agent to minimize the PPO loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>args</strong> – Parameters for the PPO pretraining. (Note: these can differ from the global command line arguments)</p></li>
<li><p><strong>agent_state</strong> – AgentState (flax TrainState) object.</p></li>
<li><p><strong>storage</strong> – Storage storing data collected in episodes.</p></li>
<li><p><strong>max_policy_lipschitz</strong> – Limit on the policy Lipschitz constant, above which a cost is incurred.</p></li>
<li><p><strong>key</strong> – random number generator key</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>agent_state: AgentState object.</p></li>
<li><p>loss: total loss</p></li>
<li><p>pg_loss: policy loss</p></li>
<li><p>v_loss: value loss</p></li>
<li><p>entropy_loss: entropy loss</p></li>
<li><p>approx_kl: approximate KL divergence</p></li>
<li><p>key: random number generator key</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.ppo_jax.update_ppo_jit">
<span class="sig-prename descclassname"><span class="pre">core.ppo_jax.</span></span><span class="sig-name descname"><span class="pre">update_ppo_jit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.PPOargs" title="core.ppo_jax.PPOargs"><span class="pre">PPOargs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.AgentState" title="core.ppo_jax.AgentState"><span class="pre">AgentState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.ppo_jax.Storage" title="core.ppo_jax.Storage"><span class="pre">Storage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_policy_lipschitz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/ppo_jax.html#update_ppo_jit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.ppo_jax.update_ppo_jit" title="Link to this definition"></a></dt>
<dd><p>Update PPO agent to minimize the PPO loss. (jitted function)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>args</strong> – Parameters for the PPO pretraining. (Note: these can differ from the global command line arguments)</p></li>
<li><p><strong>agent_state</strong> – AgentState (flax TrainState) object.</p></li>
<li><p><strong>storage</strong> – Storage storing data collected in episodes.</p></li>
<li><p><strong>max_policy_lipschitz</strong> – Limit on the policy Lipschitz constant, above which a cost is incurred.</p></li>
<li><p><strong>key</strong> – random number generator key</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-core.verifier">
<span id="core-verifier-module"></span><h2>core.verifier module<a class="headerlink" href="#module-core.verifier" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.verifier.Verifier">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.verifier.</span></span><span class="sig-name descname"><span class="pre">Verifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#Verifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.Verifier" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Object for the verifier from the learner-verifier framework</p>
<dl class="py method">
<dt class="sig sig-object py" id="core.verifier.Verifier.check_and_refine">
<span class="sig-name descname"><span class="pre">check_and_refine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Policy_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#Verifier.check_and_refine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.Verifier.check_and_refine" title="Link to this definition"></a></dt>
<dd><p>Check the three supermartingale conditions, and refine the grid while not.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iteration</strong> – CEGIS iteration index.</p></li>
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>args</strong> – Command line arguments.</p></li>
<li><p><strong>V_state</strong> – Certificate network.</p></li>
<li><p><strong>Policy_state</strong> – Policy network.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>SAT : True if the check succeeded (possibly after refinements), and hence a supermartingale is learned. False otherwise.</p></li>
<li><p>counterx : Counterexamples to the RASM conditions.</p></li>
<li><p>counterx_weights : Counterexample weights per RASM condition.</p></li>
<li><p>counterx_hard : Boolean array, specifying whether the counterexample is hard.</p></li>
<li><p>total_samples_used : total number of samples used by the local refinement loop.</p></li>
<li><p>total_samples_naive : number of sampled that would have been used by global refinement.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.verifier.Verifier.check_expected_decrease">
<span class="sig-name descname"><span class="pre">check_expected_decrease</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Kprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lip_certificate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compare_with_lip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#Verifier.check_expected_decrease"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.Verifier.check_expected_decrease" title="Link to this definition"></a></dt>
<dd><p>Check the expected decrease condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iteration</strong> – CEGIS iteration index.</p></li>
<li><p><strong>grid</strong> – Verification grid.</p></li>
<li><p><strong>Kprime</strong> – Combined Lipschitz constant.</p></li>
<li><p><strong>lip_certificate</strong> – Lipschitz constant of the certificate network.</p></li>
<li><p><strong>compare_with_lip</strong> – Compare IBP and Lipschitz for the old state. (For the new state, Lipschitz is always used)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>x_decrease_violations : list of violations of the expected decrease condition.</p></li>
<li><p>len(hardViolations) : number of hard violations.</p></li>
<li><p>violation_weights : list specifying the weight of each violation.</p></li>
<li><p>hard_violation_idxs : boolean array, specifying which violations are hard.</p></li>
<li><p>suggested_mesh_expDecr : Suggested meshes for each violation.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.verifier.Verifier.check_initial_states">
<span class="sig-name descname"><span class="pre">check_initial_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Kprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lip_certificate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compare_with_lip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#Verifier.check_initial_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.Verifier.check_initial_states" title="Link to this definition"></a></dt>
<dd><p>Check the initial state condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> – Verification grid.</p></li>
<li><p><strong>Kprime</strong> – Combined Lipschitz constant.</p></li>
<li><p><strong>lip_certificate</strong> – Lipschitz constant of the certificate network.</p></li>
<li><p><strong>compare_with_lip</strong> – Compare IBP and Lipschitz.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>x_init_vio_IBP : list of violations of the initial condition.</p></li>
<li><p>x_init_vioNumHard : number of hard violations.</p></li>
<li><p>weights_init : list specifying the weight of each violation.</p></li>
<li><p>V_init &gt; 0 : boolean array, specifying which violations are hard.</p></li>
<li><p>suggested_mesh_init : Suggested meshes for each violation.</p></li>
<li><p>np.max(V_init_ub) if len(V_init_ub) &gt; 0 else 0 : Maximal value among the (remaining) cells in the unsafe region.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.verifier.Verifier.check_unsafe_state">
<span class="sig-name descname"><span class="pre">check_unsafe_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Kprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lip_certificate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compare_with_lip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#Verifier.check_unsafe_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.Verifier.check_unsafe_state" title="Link to this definition"></a></dt>
<dd><p>Check the unsafe state condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> – Verification grid.</p></li>
<li><p><strong>Kprime</strong> – Combined Lipschitz constant.</p></li>
<li><p><strong>lip_certificate</strong> – Lipschitz constant of the certificate network.</p></li>
<li><p><strong>compare_with_lip</strong> – Compare IBP and Lipschitz.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>x_unsafe_vio_IBP : list of violations of the unsafe condition.</p></li>
<li><p>x_unsafe_vioNumHard : number of hard violations.</p></li>
<li><p>weights_unsafe : list specifying the weight of each violation.</p></li>
<li><p>V_unsafe &lt; 0 : boolean array, specifying which violations are hard.</p></li>
<li><p>suggested_mesh_unsafe : Suggested meshes for each violation.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.verifier.Verifier.expectation_Vx_plus">
<span class="sig-name descname"><span class="pre">expectation_Vx_plus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_lb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_ub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_ub</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#Verifier.expectation_Vx_plus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.Verifier.expectation_Vx_plus" title="Link to this definition"></a></dt>
<dd><p>Compute expectation over V(x_{k+1}).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V_state</strong> – Certificate network.</p></li>
<li><p><strong>V_params</strong> – Parameters of the certificate network.</p></li>
<li><p><strong>x</strong> – State.</p></li>
<li><p><strong>u</strong> – Action.</p></li>
<li><p><strong>w_lb</strong> – Noise lower bounds of the noise partition cells.</p></li>
<li><p><strong>w_ub</strong> – Noise upper bounds of the noise partition cells.</p></li>
<li><p><strong>prob_ub</strong> – Probabilities of the noise partition cells.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Upper bound on the expectation of V(x_{k+1}).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.verifier.Verifier.get_Lipschitz">
<span class="sig-name descname"><span class="pre">get_Lipschitz</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#Verifier.get_Lipschitz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.Verifier.get_Lipschitz" title="Link to this definition"></a></dt>
<dd><p>Compute the Lipschitz constants of the policy and certificate networks 
and the combined Lipschitz constant Kprime.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>lip_policy: Lipschitz constant of the policy network.</p></li>
<li><p>lip_certificate: Lipschitz constant of the certificate network.</p></li>
<li><p>Kprime: combined Lipschitz constant of x mapsto V(f(x, pi(x), noise)).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.verifier.Verifier.local_grid_refinement">
<span class="sig-name descname"><span class="pre">local_grid_refinement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_mesh_sizes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Linfty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmap_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#Verifier.local_grid_refinement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.Verifier.local_grid_refinement" title="Link to this definition"></a></dt>
<dd><p>Refine the given array of points in the state space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>data</strong> – Current centers and cell widths of cells in the grid.</p></li>
<li><p><strong>new_mesh_sizes</strong> – New cell widths per current cell.</p></li>
<li><p><strong>Linfty</strong> – If true, use Linfty norm.</p></li>
<li><p><strong>vmap_threshold</strong> – Treshold beyond which a jittable vmap is used for refinement.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Refined grid (as a stacked numpy array).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.verifier.Verifier.partition_noise">
<span class="sig-name descname"><span class="pre">partition_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#Verifier.partition_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.Verifier.partition_noise" title="Link to this definition"></a></dt>
<dd><p>Discretize the noise space and compute corresponding probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment.</p></li>
<li><p><strong>args</strong> – Command line arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.verifier.Verifier.refine">
<span class="sig-name descname"><span class="pre">refine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suggested_mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_nr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#Verifier.refine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.Verifier.refine" title="Link to this definition"></a></dt>
<dd><p>Refine the verification grid (either using local or uniform refinements).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cx</strong> – Counterexamples.</p></li>
<li><p><strong>suggested_mesh</strong> – Suggested mesh (per counterexample).</p></li>
<li><p><strong>refine_nr</strong> – Number of completed refinements.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>refine: boolean, True if the refinement was executed.</p></li>
<li><p>grid: the refined grid (or None, if refine is False).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.verifier.Verifier.step_noise_batch">
<span class="sig-name descname"><span class="pre">step_noise_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#Verifier.step_noise_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.Verifier.step_noise_batch" title="Link to this definition"></a></dt>
<dd><p>Approximate V(x_{k+1})-V(x_k) by taking the average over a set of noise values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V_state</strong> – Certificate network.</p></li>
<li><p><strong>V_params</strong> – Parameters of the certificate network.</p></li>
<li><p><strong>x</strong> – State.</p></li>
<li><p><strong>u</strong> – Action.</p></li>
<li><p><strong>noise_key</strong> – random number generator key.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Approximation of V(x_{k+1})-V(x_k).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.verifier.Verifier.uniform_grid">
<span class="sig-name descname"><span class="pre">uniform_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Linfty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#Verifier.uniform_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.Verifier.uniform_grid" title="Link to this definition"></a></dt>
<dd><p>Defines a rectangular gridding of the state space, used by the verifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment. Gym environment object.</p></li>
<li><p><strong>mesh_size</strong> – This is the mesh size used to define the grid.</p></li>
<li><p><strong>Linfty</strong> – If true, use Linfty norm for gridding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gridding of the state space.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.verifier.batched_forward_pass">
<span class="sig-prename descclassname"><span class="pre">core.verifier.</span></span><span class="sig-name descname"><span class="pre">batched_forward_pass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apply_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#batched_forward_pass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.batched_forward_pass" title="Link to this definition"></a></dt>
<dd><p>Do a forward pass for the given network, split into batches of given size (can be needed to avoid OOM errors).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>apply_fn</strong> – Forward pass function of network.</p></li>
<li><p><strong>params</strong> – Parameters of network.</p></li>
<li><p><strong>samples</strong> – Samples to feed through the network.</p></li>
<li><p><strong>out_dim</strong> – Output dimension.</p></li>
<li><p><strong>batch_size</strong> – Batch size (integer).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the forward pass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.verifier.batched_forward_pass_ibp">
<span class="sig-prename descclassname"><span class="pre">core.verifier.</span></span><span class="sig-name descname"><span class="pre">batched_forward_pass_ibp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apply_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#batched_forward_pass_ibp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.batched_forward_pass_ibp" title="Link to this definition"></a></dt>
<dd><p>Do a forward pass for the given network, split into batches of given size (can be needed to avoid OOM errors).
This version of the function uses IBP. Also flattens the output automatically.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>apply_fn</strong> – Forward pass function of network</p></li>
<li><p><strong>params</strong> – Parameters of network</p></li>
<li><p><strong>samples</strong> – Samples to feed through the network</p></li>
<li><p><strong>epsilon</strong> – Epsilon by which state regions are enlarged</p></li>
<li><p><strong>out_dim</strong> – Output dimension</p></li>
<li><p><strong>batch_size</strong> – Batch size (integer)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output (lower bound and upper bound)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="core.verifier.grid_multiply_shift">
<span class="sig-prename descclassname"><span class="pre">core.verifier.</span></span><span class="sig-name descname"><span class="pre">grid_multiply_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/core/verifier.html#grid_multiply_shift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.verifier.grid_multiply_shift" title="Link to this definition"></a></dt>
<dd><p>Split a cell into num cells per dimension by shifting and scaling an existing partitioned grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> – Grid partitioning cell into num cells in each dimension.</p></li>
<li><p><strong>lb</strong> – Lower bound of the cell.</p></li>
<li><p><strong>ub</strong> – Upper bound of the cell.</p></li>
<li><p><strong>num</strong> – Number of cells into which the cell should be split.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Shifted and scaled grid.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-core">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-core" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="collect_checkpoints.html" class="btn btn-neutral float-left" title="collect_checkpoints module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="main_genOtherSeeds.html" class="btn btn-neutral float-right" title="main_genOtherSeeds module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Thom Badings, Wietze Koops, Sebastian Junges, Nils Jansen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>